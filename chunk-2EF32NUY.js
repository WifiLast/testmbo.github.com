import{a as f,b as w,c as v,e as C,f as M,g as n,h as o,i as h,k as i,m as y,p as P,t as S}from"./chunk-F3Q6RXN2.js";var E=class b{constructor(e){this.modelCacheService=e}pdfDoc=null;ngOnInit(){this.loadExternalScripts()}ngAfterViewInit(){setTimeout(()=>{this.initializeViewer(),this.initializePDF(),this.preloadModelForAR()},100)}preloadModelForAR(){setTimeout(()=>{let e="https://pub-307281ad98f24254a52da2bb71f8637b.r2.dev/1001029000-AG00-ZLA-005-C-Cooling%20Tower%202.0%20U.glb";fetch(e,{mode:"cors"}).then(()=>console.log(`\u2713 Preloaded for AR: ${e.split("/").pop()}`)).catch(t=>console.warn(`Failed to preload: ${e.split("/").pop()}`,t))},1e3)}loadExternalScripts(){if(!document.querySelector('script[src*="jszip"]')){let e=document.createElement("script");e.src="https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js",document.head.appendChild(e)}if(!document.querySelector('script[src*="model-viewer"]')){let e=document.createElement("script");e.type="module",e.src="https://ajax.googleapis.com/ajax/libs/model-viewer/4.0.0/model-viewer.min.js",document.head.appendChild(e),e.onload=()=>{customElements.whenDefined("model-viewer").then(()=>{window.ModelViewerStatic&&(window.ModelViewerStatic.minimumRenderScale=1)})}}if(!document.querySelector('script[src*="pdfjs-dist"]')){let e=document.createElement("script");e.src="https://cdn.jsdelivr.net/npm/pdfjs-dist@3.11.174/build/pdf.min.js",e.onload=()=>{typeof pdfjsLib<"u"&&(pdfjsLib.GlobalWorkerOptions.workerSrc="https://cdn.jsdelivr.net/npm/pdfjs-dist@3.11.174/build/pdf.worker.min.js")},document.head.appendChild(e)}}initializeViewer(){let e=document.getElementById("arModell"),t=document.getElementById("mvLoading"),r=t?.querySelector(".mv-loading-text");e&&(e.addEventListener("load",()=>{t&&(t.style.display="none"),setTimeout(()=>{let l=e.shadowRoot?.querySelector('button[slot="ar-button"]')||e.shadowRoot?.querySelector(".ar-button")||e.shadowRoot?.querySelector('[aria-label*="AR"]');l?(console.log("AR button found, adding interceptor"),l.addEventListener("click",d=>f(this,null,function*(){d.preventDefault(),d.stopPropagation(),console.log("AR button clicked, switching to original URL...");let a=this.modelCacheService.getOriginalUrl("ct2");a&&e.src!==a&&(e.src=a,yield new Promise(s=>{let p=()=>{console.log("Original URL loaded, activating AR..."),e.removeEventListener("load",p),s()};e.addEventListener("load",p),setTimeout(()=>{e.removeEventListener("load",p),s()},1e4)})),e.activateAR()}),{capture:!0})):console.warn("AR button not found in shadow DOM")},1e3)},{once:!0}),e.addEventListener("progress",l=>{let d=Math.round((l.detail?.totalProgress||0)*100);if(!(!Number.isFinite(d)||d<=0||d>=100)&&r){if(!r.querySelector(".mv-progress")){let s=document.createElement("span");s.className="mv-progress",r.appendChild(s)}let a=r.querySelector(".mv-progress");a&&(a.textContent=` ${d}%`)}}),e.addEventListener("error",()=>{r&&(r.textContent="Ladevorgang fehlgeschlagen")}),this.waitForCacheAndLoad())}waitForCacheAndLoad(){return f(this,null,function*(){let e=this.modelCacheService.getModel("ct2");if(e){console.log("\u2713 CT2 model loaded from cache instantly!"),this.loadModelFromUrl(e);return}console.log("CT2 model not cached yet, waiting...");let t=yield this.modelCacheService.waitForModel("ct2",2e3);if(t)console.log("\u2713 CT2 model loaded from cache after brief wait"),this.loadModelFromUrl(t);else{console.log("Cache timeout - fallback to original uncompressed URL");let r=this.modelCacheService.getOriginalUrl("ct2");r?(console.log("\u2713 Loading CT2 from original URL:",r),this.loadModelFromUrl(r)):console.error("Failed to load CT2 model - no cache and no original URL available")}})}loadGLBFromZip(e){return f(this,null,function*(){try{console.log("Loading ZIP:",e);let t=yield fetch(e);if(!t.ok)throw new Error(`Failed to fetch ${e}: ${t.statusText}`);let r=yield t.arrayBuffer(),d=yield new JSZip().loadAsync(r),a=null;for(let c in d.files)if(c.toLowerCase().endsWith(".glb")){a=c;break}if(!a)throw new Error("No GLB file found in ZIP archive");console.log(`Extracting ${a}...`);let s=d.file(a);if(!s)throw new Error("Could not access file in archive");let p=yield s.async("arraybuffer"),g=new Uint8Array(p,0,4);if(!(g[0]===103&&g[1]===108&&g[2]===84&&g[3]===70))throw new Error("Extracted file is not a valid GLB model");let m=new Blob([p],{type:"model/gltf-binary"}),u=URL.createObjectURL(m);return console.log("GLB extracted successfully"),u}catch(t){throw console.error("Error loading GLB from ZIP:",t),t}})}loadModel(){return f(this,null,function*(){try{let e=this.modelCacheService.getModel("ct2");if(e)console.log("\u2713 Using cached CT2 model"),this.loadModelFromUrl(e);else{console.log("CT2 model not in cache, waiting...");let t=yield this.modelCacheService.waitForModel("ct2",5e3);if(t)console.log("\u2713 Got CT2 from service after waiting"),this.loadModelFromUrl(t);else{console.log("Cache timeout for CT2 - fallback to original URL");let r=this.modelCacheService.getOriginalUrl("ct2");r?(console.log("\u2713 Loading CT2 from original URL"),this.loadModelFromUrl(r)):console.error("Failed to load CT2 model - no cache and no original URL available")}}}catch(e){console.error("Failed to load Cooling Tower model:",e)}})}loadModelFromUrl(e){let t=document.getElementById("arModell");t&&(t.src=e)}initializePDF(){return f(this,null,function*(){let e=document.getElementById("pdfContainer"),t="/pdf/CT2.0_Datasheet.pdf";if(!e){console.warn("PDF container not found");return}console.log("Initializing PDF viewer for:",t);let r=setInterval(()=>{typeof pdfjsLib<"u"&&(clearInterval(r),console.log("PDF.js library loaded, loading document..."),pdfjsLib.getDocument(t).promise.then(l=>{console.log(`PDF loaded successfully: ${l.numPages} pages`),this.pdfDoc=l,this.renderAllPages(e)}).catch(l=>{console.error("Failed to load PDF:",t,l),e.innerHTML=`<p style="color: #ff6b6b; padding: 20px;">PDF konnte nicht geladen werden: ${l.message}</p>`}))},100);setTimeout(()=>{clearInterval(r),this.pdfDoc||console.warn("PDF.js library timeout - check if library is loading")},1e4)})}renderAllPages(e){return f(this,null,function*(){if(!this.pdfDoc)return;e.innerHTML="";let t=this.pdfDoc.numPages,r=Math.floor(Math.min(e.clientWidth||1180,880)),l=Math.max(1,Math.floor(window.devicePixelRatio||1)),d=2;for(let a=1;a<=t;a++){let s=yield this.pdfDoc.getPage(a),p=s.getViewport({scale:1}),g=r/p.width,x=s.getViewport({scale:g*l*d}),m=document.createElement("canvas"),u=m.getContext("2d",{alpha:!1});m.width=Math.floor(x.width),m.height=Math.floor(x.height),m.style.width=Math.floor(p.width*g)+"px",m.style.height=Math.floor(p.height*g)+"px",u.fillStyle="#fff",u.fillRect(0,0,m.width,m.height),yield s.render({canvasContext:u,viewport:x,intent:"print",background:"rgba(255,255,255,1)"}).promise;let c=document.createElement("div");c.className="pdf-page",c.style.margin="12px auto",c.style.width=r+"px",c.style.borderRadius="12px",c.style.overflow="hidden",c.style.border="1px solid rgba(255,255,255,.12)",c.style.background="#fff",c.appendChild(m),e.appendChild(c)}})}static \u0275fac=function(t){return new(t||b)(C(S))};static \u0275cmp=M({type:b,selectors:[["app-projekt-ct"]],decls:69,vars:0,consts:[[1,"backdrop"],[1,"hero"],[1,"inner"],[1,"kicker"],[1,"sub"],[1,"tags"],[1,"tag"],[1,"container"],[1,"grid"],["id","viewerCard",1,"card","viewer-wrap"],["id","arModell","loading","eager","powerPreference","high-performance","poster","https://wifilast.github.io/testmbo.github.com/bilder/CT2.webp","alt","Cooling Tower 2.0","ar","","ar-modes","scene-viewer quick-look","camera-controls","","auto-rotate","","shadow-intensity","1"],["id","mvLoading","role","status","aria-live","polite",1,"mv-loading"],["aria-hidden","true",1,"mv-spinner"],[1,"mv-loading-text"],["role","note","aria-label","AR Hinweis",1,"ar-hint"],["viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2.2","stroke-linecap","round","stroke-linejoin","round","aria-hidden","true"],["d","M12 2 20 6 20 18 12 22 4 18 4 6 12 2z"],["d","M12 2v20M4 6l8 4 8-4M4 18l8-4 8 4"],[1,"card","side"],[1,"meta"],[2,"margin-top","6px","color","var(--muted)"],["id","datasheet",1,"pdf","card"],[1,"pdf-head"],[1,"pdf-title"],["href","https://wifilast.github.io/testmbo.github.com/pdf/CT2.0_Datasheet.pdf","target","_blank","rel","noopener",1,"btn","btn--pill","btn--sm"],["id","pdfContainer"],["routerLink","/",1,"btn","btn--pill",2,"display","block","width","max-content","margin","30px auto 0"]],template:function(t,r){t&1&&(h(0,"div",0),n(1,"section",1)(2,"div",2)(3,"div",3),i(4,"Projekt"),o(),n(5,"h1"),i(6,"Cooling Tower 2.0"),o(),n(7,"p",4),i(8,`Der Cooling Tower 2.0 dient zur pr\xE4zisen Fl\xFCssigkeitsk\xFChlung in Hightech-Anlagen wie Mask-Writer-Systemen, Elektronenmikroskopen, Pr\xFCfst\xE4nden oder Rechenzentren.
Er sichert durch konstante Temperaturf\xFChrung, stabile Volumenstr\xF6me und zuverl\xE4ssige Prozessregelung optimale Betriebsbedingungen f\xFCr empfindliche Prozesse.
`),o(),n(9,"div",5)(10,"span",6),i(11,"Prozessk\xFChlung"),o(),n(12,"span",6),i(13,"Pr\xE4zision \xB10,2K"),o(),n(14,"span",6),i(15,"800kW Power"),o(),n(16,"span",6),i(17,"Smart Control"),o(),n(18,"span",6),i(19,"Prozess-Stabilit\xE4t"),o(),n(20,"span",6),i(21,"Made for Performance"),o()()()(),n(22,"main",7)(23,"div",8)(24,"section",9),h(25,"model-viewer",10),n(26,"div",11),h(27,"div",12),n(28,"span",13),i(29,"Modell l\xE4dt\u2026"),o()(),n(30,"div",14),w(),n(31,"svg",15),h(32,"path",16)(33,"path",17),o(),v(),n(34,"span"),i(35," Auf dem "),n(36,"strong"),i(37,"Smartphone"),o(),i(38," das "),n(39,"em"),i(40,"AR-Symbol"),o(),i(41," im Viewer antippen, um das Modell im Raum zu platzieren. "),o()()(),n(42,"aside",18)(43,"h2"),i(44,"Spezifikationen"),o(),n(45,"div",19)(46,"div"),i(47,"Modellnummer"),o(),n(48,"div"),i(49,"1001012000"),o(),n(50,"div"),i(51,"Kategorie"),o(),n(52,"div"),i(53,"Cooling Tower 2.0"),o(),n(54,"div"),i(55,"Status"),o(),n(56,"div"),i(57,"Pr\xE4sentationsmodell"),o()(),n(58,"p",20),i(59,"Gesten: Drehen/Zoomen. AR startet \xFCber das Viewer-Icon (Android/iOS)."),o()()(),n(60,"section",21)(61,"div",22)(62,"h3",23),i(63,"Datenblatt \u2013 Vorschau"),o(),n(64,"a",24),i(65,"PDF \xF6ffnen"),o()(),h(66,"div",25),o(),n(67,"a",26),i(68,"\u27F5 Zur Startseite"),o()())},dependencies:[y,P],styles:["[_ngcontent-%COMP%]:root{--bg:#050511;--panel:#0a0a1c;--glass:rgba(255,255,255,.06);--txt:#e9ecff;--muted:#a9b1d6;--neon:#6d9eff;--neon2:#11ffe1;--container:1180px;--radius:18px}*[_ngcontent-%COMP%]{box-sizing:border-box}html[_ngcontent-%COMP%], body[_ngcontent-%COMP%]{height:100%}body[_ngcontent-%COMP%]{margin:0;color:var(--txt);font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;background:var(--bg);overflow-x:hidden}.nav[_ngcontent-%COMP%]{position:sticky;top:0;z-index:30;-webkit-backdrop-filter:blur(10px) saturate(140%);backdrop-filter:blur(10px) saturate(140%);background:#0a0a1e73;border-bottom:1px solid rgba(255,255,255,.08)}.nav[_ngcontent-%COMP%]   .inner[_ngcontent-%COMP%]{max-width:var(--container);margin:0 auto;padding:12px 18px;display:flex;align-items:center;justify-content:space-between}.brand[_ngcontent-%COMP%]{display:flex;gap:10px;align-items:center;font-weight:900}.brand-logo[_ngcontent-%COMP%]{height:26px;width:auto;display:block;filter:invert(1) brightness(1.9) drop-shadow(0 0 4px rgba(255,255,255,.55)) drop-shadow(0 0 10px rgba(255,255,255,.35));opacity:.95}.hero[_ngcontent-%COMP%]   .inner[_ngcontent-%COMP%]{max-width:var(--container);margin:0 auto;padding:34px 18px 8px}.kicker[_ngcontent-%COMP%]{color:var(--neon);font-weight:900;text-transform:uppercase;letter-spacing:.12em;font-size:12px}h1[_ngcontent-%COMP%]{margin:.3rem 0 .25rem;font-size:clamp(30px,5vw,54px);line-height:1.06}.sub[_ngcontent-%COMP%]{color:var(--muted);max-width:900px}.tags[_ngcontent-%COMP%]{display:flex;gap:8px;flex-wrap:wrap;margin-top:12px}.tag[_ngcontent-%COMP%]{font-size:12px;font-weight:800;padding:6px 10px;border-radius:999px;background:var(--glass);border:1px solid rgba(255,255,255,.12)}.container[_ngcontent-%COMP%]{max-width:var(--container);margin:0 auto;padding:16px 18px 90px}.grid[_ngcontent-%COMP%]{display:grid;gap:18px;grid-template-columns:1fr 340px}@media (max-width:1100px){.grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}.card[_ngcontent-%COMP%]{position:relative;border-radius:var(--radius);overflow:hidden;background:linear-gradient(180deg,#ffffff0d,#ffffff05);border:1px solid rgba(255,255,255,.12);box-shadow:0 10px 36px #00000080,0 0 20px #6d9eff38}.viewer-wrap[_ngcontent-%COMP%]{padding:14px;background:linear-gradient(180deg,#6d9eff14,#ffffff05)}model-viewer[_ngcontent-%COMP%]{width:100%;height:min(64vh,720px);min-height:420px;background:#0b0b20;border-radius:14px;border:1px solid rgba(255,255,255,.12);touch-action:none;overscroll-behavior:contain;-webkit-user-select:none;-webkit-touch-callout:none}.ar-hint[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;margin:10px 0 0;padding:8px 12px;font-size:13px;line-height:1.2;color:#dfe7ff;background:linear-gradient(180deg,#ffffff0f,#ffffff08);border:1px solid rgba(109,158,255,.25);border-radius:12px;box-shadow:0 2px 14px #00000059,0 0 12px #6d9eff1a;-webkit-backdrop-filter:blur(6px) saturate(130%);backdrop-filter:blur(6px) saturate(130%)}.ar-hint[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#fff;font-weight:800}.ar-hint[_ngcontent-%COMP%]   em[_ngcontent-%COMP%]{font-style:normal;color:var(--neon);font-weight:800}.ar-hint[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:18px;height:18px;flex:0 0 18px;color:var(--neon);filter:drop-shadow(0 0 6px rgba(109,158,255,.35));opacity:.95}.side[_ngcontent-%COMP%]{padding:16px}.side[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:clamp(22px,2.2vw,28px);margin:0 0 10px}.meta[_ngcontent-%COMP%]{display:grid;grid-template-columns:150px 1fr;gap:8px 12px;font-size:15px}.meta[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:first-child{color:#a8c2ff;font-weight:800}.pdf.card[_ngcontent-%COMP%]{margin-top:18px;padding:14px}.pdf-head[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;gap:10px;margin-bottom:8px}.pdf-title[_ngcontent-%COMP%]{font-size:clamp(20px,2vw,26px);margin:0}.pdf-page[_ngcontent-%COMP%]{background:#fff}.pdf-page[_ngcontent-%COMP%]   canvas[_ngcontent-%COMP%]{display:block;image-rendering:auto}.backdrop[_ngcontent-%COMP%]{position:fixed;inset:0;z-index:-1;background:radial-gradient(circle at 30% 10%,rgba(255,91,215,.15),transparent 50%),radial-gradient(circle at 85% 40%,rgba(109,158,255,.18),transparent 55%),#050511}"]})};export{E as ProjektCt};
